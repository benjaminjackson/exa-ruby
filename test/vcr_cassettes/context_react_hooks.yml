---
http_interactions:
- request:
    method: post
    uri: https://api.exa.ai/context
    body:
      encoding: UTF-8
      string: '{"query":"how to use React hooks for state management","tokensNum":5000}'
    headers:
      X-Api-Key:
      - "<EXA_API_KEY>"
      User-Agent:
      - Faraday v2.14.0
      Content-Type:
      - application/json
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
  response:
    status:
      code: 200
      message: OK
    headers:
      Date:
      - Tue, 28 Oct 2025 16:13:28 GMT
      Content-Type:
      - application/json; charset=utf-8
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      Nel:
      - '{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'
      Content-Security-Policy:
      - frame-ancestors 'self'
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Origin-Agent-Cluster:
      - "?1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - 'off'
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - DENY
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - '0'
      Vary:
      - Origin
      Access-Control-Allow-Credentials:
      - 'true'
      X-Ratelimit-Limit:
      - '9007199254740991'
      X-Ratelimit-Remaining:
      - '9007199254740990'
      X-Ratelimit-Reset:
      - '1761668007'
      Etag:
      - W/"5079-D1QN15GMG3FlrEBBowbcz9aG4vI"
      Report-To:
      - '{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=5mwEJIroXmQqddOLaxnDMvM2d5NQTrs2CeAtboOhhrj33k%2FcTf%2BmALD5LnYhCGf9n5CvZ6EASpsHQoxuM0S5LU3XChRo%2BCo8dAd44AZ53gfRvOwDxw%3D%3D"}]}'
      Cf-Cache-Status:
      - DYNAMIC
      Server:
      - cloudflare
      Cf-Ray:
      - 995bb86ace937a99-EWR
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        eyJyZXF1ZXN0SWQiOiIzMWJjMWNiMzc3MjYzMTdiMzhkMWYyZmMzMGQ5Y2NmZSIsInF1ZXJ5IjoiaG93IHRvIHVzZSBSZWFjdCBob29rcyBmb3Igc3RhdGUgbWFuYWdlbWVudCIsInJlc3BvbnNlIjoiIyMgVXNpbmcgdGhlIFN0YXRlIEhvb2tcblxuaHR0cHM6Ly9sZWdhY3kucmVhY3Rqcy5vcmcvZG9jcy9ob29rcy1zdGF0ZS5odG1sXG5cbmBgYFxuZnVuY3Rpb24gaGFuZGxlT3JhbmdlQ2xpY2soKSB7XG4gLy8gU2ltaWxhciB0byB0aGlzLnNldFN0YXRlKHsgZnJ1aXQ6ICdvcmFuZ2UnIH0pXG4gc2V0RnJ1aXQoJ29yYW5nZScpO1xuIH1cbmBgYFxuXG4jIyBTdGF0ZSBNYW5hZ2VtZW50IHdpdGggdXNlU3RhdGUgSG9vayBpbiBSZWFjdFxuXG5odHRwczovL3d3dy5nZWVrc2ZvcmdlZWtzLm9yZy9yZWFjdGpzL3N0YXRlLW1hbmFnZW1lbnQtd2l0aC11c2VzdGF0ZS1ob29rLWluLXJlYWN0L1xuXG5gYGBcbmltcG9ydFJlYWN0LHtcbnVzZVN0YXRlXG59XG5mcm9tJ3JlYWN0JztcblxuZnVuY3Rpb25JbnB1dEZlaWxkKCl7XG5jb25zdFtuYW1lLHNldE5hbWVdPXVzZVN0YXRlKCcnKTtcblxuY29uc3RoYW5kbGVDaGFuZ2U9KGV2ZW50KT0+e1xuc2V0TmFtZShldmVudC50YXJnZXQudmFsdWUpO1xufVxuXG5yZXR1cm4oXG5cbk5hbWU6XG5cbkVudGVyZWRuYW1lOntuYW1lfVxuXG4pO1xufVxuXG5leHBvcnRkZWZhdWx0SW5wdXRGZWlsZDtcbmBgYFxuXG4jIyBIb3cgVG8gTWFuYWdlIFN0YXRlIHdpdGggSG9va3Mgb24gUmVhY3QgQ29tcG9uZW50c1xuXG5odHRwczovL3d3dy5kaWdpdGFsb2NlYW4uY29tL2NvbW11bml0eS90dXRvcmlhbHMvaG93LXRvLW1hbmFnZS1zdGF0ZS13aXRoLWhvb2tzLW9uLXJlYWN0LWNvbXBvbmVudHNcblxuYGBgXG5pbXBvcnRcblJlYWN0LHt1c2VSZWR1Y2VyfVxuZnJvbVxuJ3JlYWN0J1xuO1xuaW1wb3J0XG4nLi9Qcm9kdWN0LmNzcydcbjtcbmNvbnN0XG5jdXJyZW5jeU9wdGlvbnM9XG57XG5taW5pbXVtRnJhY3Rpb25EaWdpdHNcbjpcbjJcbixcbm1heGltdW1GcmFjdGlvbkRpZ2l0c1xuOlxuMlxuLFxufVxuZnVuY3Rpb25cbmdldFRvdGFsXG4oXG4gY2FydFxuKVxue1xuIGNvbnN0XG50b3RhbD1cbmNhcnQuXG5yZWR1Y2VcbihcbihcbnRvdGFsQ29zdCxpdGVtXG4pXG49PlxudG90YWxDb3N0K1xuaXRlbS5cbnByaWNlXG4sXG4wXG4pXG47XG4gcmV0dXJuXG50b3RhbC5cbnRvTG9jYWxlU3RyaW5nXG4oXG51bmRlZmluZWRcbixcbmN1cnJlbmN5T3B0aW9ucylcbn1cbi4uLlxuZnVuY3Rpb25cbmNhcnRSZWR1Y2VyXG4oXG5zdGF0ZSxhY3Rpb25cbilcbntcbnN3aXRjaFxuKFxuYWN0aW9uLlxudHlwZVxuKVxue1xuY2FzZVxuJ2FkZCdcbjpcbnJldHVyblxuW1xuLi4uXG5zdGF0ZSxcbmFjdGlvbi5cbiBwcm9kdWN0XG5dXG47XG5jYXNlXG4ncmVtb3ZlJ1xuOlxuIGNvbnN0XG5wcm9kdWN0SW5kZXg9XG5zdGF0ZS5cbmZpbmRJbmRleFxuKFxuaXRlbVxuPT5cbml0ZW0uXG5uYW1lXG49PT1cbmFjdGlvbi5cbnByb2R1Y3Rcbi5cbm5hbWVcbilcbjtcbiBpZlxuKFxucHJvZHVjdEluZGV4IHJldHVyblxuc3RhdGU7XG4gfVxuIGNvbnN0XG51cGRhdGU9XG5bXG4uLi5cbnN0YXRlXVxuO1xudXBkYXRlLlxuc3BsaWNlXG4oXG4gcHJvZHVjdEluZGV4ICxcbjFcbilcbnJldHVyblxudXBkYXRlIGRlZmF1bHRcbjpcbnJldHVyblxuc3RhdGU7XG59XG59XG5leHBvcnRcbmRlZmF1bHRcbmZ1bmN0aW9uXG5Qcm9kdWN0XG4oXG4pXG57XG5jb25zdFxuW1xuY2FydCxcbnNldENhcnRdXG49XG51c2VSZWR1Y2VyXG4oXG5jYXJ0UmVkdWNlcixcbltcbl1cbilcbjtcbmZ1bmN0aW9uXG5hZGRcbihcbnByb2R1Y3RcbilcbntcbiBzZXRDYXJ0XG4oXG57XG5wcm9kdWN0LFxudHlwZVxuOlxuJ2FkZCdcbn1cbilcbjtcbn1cbmZ1bmN0aW9uXG5yZW1vdmVcbihcbnByb2R1Y3RcbilcbntcbiBzZXRDYXJ0XG4oXG57XG5wcm9kdWN0LFxudHlwZVxuOlxuJ3JlbW92ZSdcbn1cbilcbjtcbn1cbnJldHVyblxuKFxuXG5TaG9wcGluZ1xuQ2FydFxuOlxue1xuY2FydC5cbmxlbmd0aFxufVxudG90YWwgaXRlbXMuXG5cblRvdGFsXG46XG57XG5nZXRUb3RhbFxuKFxuIGNhcnQgKVxufVxuXG57XG5wcm9kdWN0cy5cbm1hcFxuKFxucHJvZHVjdFxuPT5cbihcblxue1xucHJvZHVjdC5cbmVtb2ppXG59XG5cbmFkZFxuKFxucHJvZHVjdClcbn1cbj5cbkFkZFxuXG5yZW1vdmVcbihcbnByb2R1Y3QpXG59XG4+XG5SZW1vdmVcblxuKVxuKVxufVxuXG4pXG59XG5gYGBcblxuIyMgdXNlQ291bnRlciBhbmQgdXNlUmVzZXR0YWJsZUNvdW50ZXIgSG9va3MgZm9yIFN0YXRlIE1hbmFnZW1lbnRcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2phbWllYnVpbGRzL3Vuc3RhdGVkLW5leHQvbWFpbi9SRUFETUUtdGgtdGgubWRcblxuYGBgXG5mdW5jdGlvbiB1c2VDb3VudGVyKCkge1xuICBsZXQgW2NvdW50LCBzZXRDb3VudF0gPSB1c2VTdGF0ZSgwKVxuICBsZXQgZGVjcmVtZW50ID0gKCkgPT4gc2V0Q291bnQoY291bnQgLSAxKVxuICBsZXQgaW5jcmVtZW50ID0gKCkgPT4gc2V0Q291bnQoY291bnQgKyAxKVxuICByZXR1cm4geyBjb3VudCwgZGVjcmVtZW50LCBpbmNyZW1lbnQsIHNldENvdW50IH1cbn1cblxubGV0IENvdW50ZXIgPSBjcmVhdGVDb250YWluZXIodXNlQ291bnRlcilcblxuZnVuY3Rpb24gdXNlUmVzZXR0YWJsZUNvdW50ZXIoKSB7XG4gIGxldCBjb3VudGVyID0gQ291bnRlci51c2VDb250YWluZXIoKVxuICBsZXQgcmVzZXQgPSAoKSA9PiBjb3VudGVyLnNldENvdW50KDApXG4gIHJldHVybiB7IC4uLmNvdW50ZXIsIHJlc2V0IH1cbn1cbmBgYFxuXG4jIyBFeGFtcGxlIEZ1bmN0aW9uIHdpdGggdXNlU3RhdGUgSG9vayBpbiBSZWFjdFxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGlzY291bnRyeS9yZWFjdC9tYWluL2NvbnRlbnQvYmxvZy8yMDE4LTExLTI3LXJlYWN0LTE2LXJvYWRtYXAubWRcblxuYGBgXG5mdW5jdGlvbiBFeGFtcGxlKCkge1xuICAvLyBEZWNsYXJlIGEgbmV3IHN0YXRlIHZhcmlhYmxlLCB3aGljaCB3ZSdsbCBjYWxsIFwiY291bnRcIlxuICBjb25zdCBbY291bnQsIHNldENvdW50XSA9IHVzZVN0YXRlKDApO1xuXG4gIHJldHVybiAoXG4gICA8ZGl2PlxuICAgICA8cD5Zb3UgY2xpY2tlZCB7Y291bnR9IHRpbWVzPC9wPlxuICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldENvdW50KGNvdW50ICsgMSl9PlxuICAgICAgIENsaWNrIG1lXG4gICAgIDwvYnV0dG9uPlxuICAgPC9kaXY+XG4gKTtcbn1cbmBgYFxuXG4jIyBHbG9iYWwgU3RhdGUgTWFuYWdlbWVudCB3aXRoIFJlYWN0IEhvb2tzXG5cbmh0dHBzOi8vYWNhZGVtaW5kLmNvbS90dXRvcmlhbHMvZ2xvYmFsLXN0YXRlLW1hbmFnZW1lbnQtd2l0aC1yZWFjdC1ob29rc1xuXG5gYGBcbihzdGF0ZSwgYWN0aW9uKSA9PiBuZXdTdGF0ZVxuYGBgXG5cbiMjIFN0YXRlQ291bnRlciBDb21wb25lbnQgVXNpbmcgdXNlU3RvcmFnZVN0YXRlIEhvb2tcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3NveWd1aWphcnJvL3JlYWN0LXN0b3JhZ2UtaG9va3MvbWFpbi9SRUFETUUubWRcblxuYGBgXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlU3RvcmFnZVN0YXRlIH0gZnJvbSAncmVhY3Qtc3RvcmFnZS1ob29rcyc7XG5cbmZ1bmN0aW9uIFN0YXRlQ291bnRlcigpIHtcbiAgY29uc3QgW2NvdW50LCBzZXRDb3VudCwgd3JpdGVFcnJvcl0gPSB1c2VTdG9yYWdlU3RhdGUoXG4gICAgbG9jYWxTdG9yYWdlLFxuICAgICdzdGF0ZS1jb3VudGVyJyxcbiAgICAwXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgPHA+WW91IGNsaWNrZWQge2NvdW50fSB0aW1lczwvcD5cbiAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0Q291bnQoY291bnQgKyAxKX0+KzwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRDb3VudChjb3VudCAtIDEpfT4tPC9idXR0b24+XG4gICAgICB7d3JpdGVFcnJvciAmJiAoXG4gICAgICAgIDxwcmU+Q2Fubm90IHdyaXRlIHRvIGxvY2FsU3RvcmFnZToge3dyaXRlRXJyb3IubWVzc2FnZX08L3ByZT5cbiAgICAgICl9XG4gICAgPC8+XG4gICk7XG59XG5gYGBcblxuIyMgQXBwIENvbXBvbmVudCBmb3IgU3VydmV5IEludGVyYWN0aW9uIE1hbmFnZW1lbnRcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1Bvc3RIb2cvcG9zdGhvZy5jb20vbWFpbi9jb250ZW50cy90dXRvcmlhbHMvcmVhY3Qtc3VydmV5cy5tZFxuXG5gYGBcbi8vIHNyYy9BcHAuanN4XG5cbmZ1bmN0aW9uIEFwcCgpIHtcbiAgLy8gLi4uIHJlc3Qgb2YgeW91ciBjb2RlIC4uLlxuXG4gIGNvbnN0IFtzaG93U3VydmV5LCBzZXRTaG93U3VydmV5XSA9IHVzZVN0YXRlKHRydWUpXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBDaGVjayBsb2NhbCBzdG9yYWdlIHRvIHNlZSBpZiB0aGUgdXNlciBoYXMgYWxyZWFkeSBzZWVuIHRoaXMgcGFydGljdWxhciBzdXJ2ZXlcbiAgICBjb25zdCBoYXNJbnRlcmFjdGVkV2l0aFN1cnZleSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBoYXNJbnRlcmFjdGVkV2l0aFN1cnZleV8ke3N1cnZleUlEfWApXG4gICAgc2V0U2hvd1N1cnZleSghaGFzSW50ZXJhY3RlZFdpdGhTdXJ2ZXkpXG4gIH0sIFtzdXJ2ZXlJRF0pXG5cbiAgY29uc3QgaGFuZGxlRGlzbWlzcyA9ICgpID0+IHtcbiAgICBzZXRTaG93U3VydmV5KGZhbHNlKVxuICAgIGNvbnNvbGUubG9nKFwiU3VydmV5IGRpc21pc3NlZCFcIilcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShgaGFzSW50ZXJhY3RlZFdpdGhTdXJ2ZXlfJHtzdXJ2ZXlJRH1gLCAndHJ1ZScpXG4gIH1cblxuICBjb25zdCBoYW5kbGVTdWJtaXQgPSAodmFsdWUpID0+IHtcbiAgICBzZXRTaG93U3VydmV5KGZhbHNlKVxuICAgIGNvbnNvbGUubG9nKFwiVXNlciBzdWJtaXR0ZWQ6XCIsIHZhbHVlKVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBoYXNJbnRlcmFjdGVkV2l0aFN1cnZleV8ke3N1cnZleUlEfWAsICd0cnVlJylcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJBcHBcIj5cbiAgICAgIDxoMT5UaGlzIGlzIG91ciBzdXJ2ZXkgdHV0b3JpYWw8L2gxPlxuICAgICAge3Nob3dTdXJ2ZXkgJiYgKFxuICAgICAgICA8U3VydmV5XG4gICAgICAgICAgdGl0bGU9e3N1cnZleVRpdGxlfVxuICAgICAgICAgIG9uRGlzbWlzcz17aGFuZGxlRGlzbWlzc31cbiAgICAgICAgICBvblN1Ym1pdD17aGFuZGxlU3VibWl0fVxuICAgICAgICAvPlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcHBcbmBgYFxuXG4jIyBBcHAgQ29tcG9uZW50IFVzaW5nIHVzZUNvdW50ZXIgSG9vayBmb3IgU3RhdGUgTWFuYWdlbWVudFxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYXRsYXNzaWFuL3JlYWN0LXN3ZWV0LXN0YXRlL21haW4vZG9jcy9iYXNpY3MvaG9vay5tZFxuXG5gYGBcbi8vIGFwcC5qc1xuaW1wb3J0IHsgdXNlQ291bnRlciB9IGZyb20gJy4vY29tcG9uZW50cy9jb3VudGVyJztcblxuY29uc3QgQXBwID0gKCkgPT4ge1xuICBjb25zdCBbc3RhdGUsIGFjdGlvbnNdID0gdXNlQ291bnRlcigpO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIHtzdGF0ZS5jb3VudH1cbiAgICAgIDxidXR0b24gb25DbGljaz17YWN0aW9ucy5pbmNyZW1lbnR9PkFkZCBvbmU8L2J1dHRvbj5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5gYGBcblxuIyMgQ3VzdG9tIEhvb2sgdXNlTG9jYWxTdG9yYWdlIGZvciBSZWFjdCBTdGF0ZSBNYW5hZ2VtZW50XG5cbmh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zb3lndWwvUXVhbnRpY0Rldi9tYWluL3dlYi93aGF0LWlzLXJlYWN0LWFuZC13aHktc2hvdWxkLWktdXNlLWl0L1JFQURNRS5tZFxuXG5gYGBcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5cbmZ1bmN0aW9uIHVzZUxvY2FsU3RvcmFnZShrZXksIGluaXRpYWxWYWx1ZSkge1xuICBjb25zdCBbc3RvcmVkVmFsdWUsIHNldFN0b3JlZFZhbHVlXSA9IHVzZVN0YXRlKCgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaXRlbSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgcmV0dXJuIGl0ZW0gPyBKU09OLnBhcnNlKGl0ZW0pIDogaW5pdGlhbFZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gaW5pdGlhbFZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShzdG9yZWRWYWx1ZSkpO1xuICB9LCBba2V5LCBzdG9yZWRWYWx1ZV0pO1xuXG4gIHJldHVybiBbc3RvcmVkVmFsdWUsIHNldFN0b3JlZFZhbHVlXTtcbn1cblxuZnVuY3Rpb24gQXBwKCkge1xuICBjb25zdCBbbmFtZSwgc2V0TmFtZV0gPSB1c2VMb2NhbFN0b3JhZ2UoJ25hbWUnLCAnJyk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2PlxuICAgICAgPGlucHV0XG4gICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgdmFsdWU9e25hbWV9XG4gICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0TmFtZShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAvPlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBBcHA7XG5gYGBcblxuIyMganMgc3JjL0FwcC5qcyBSZXN1bHQgMVxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVhY3Rqcy96aC1oYW5zLnJlYWN0LmRldi9tYWluL3NyYy9jb250ZW50L2xlYXJuL2V4dHJhY3Rpbmctc3RhdGUtbG9naWMtaW50by1hLXJlZHVjZXIubWRcblxuYGBgXG5pbXBvcnQgeyB1c2VSZWR1Y2VyIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IEFkZFRhc2sgZnJvbSAnLi9BZGRUYXNrLmpzJztcbmltcG9ydCBUYXNrTGlzdCBmcm9tICcuL1Rhc2tMaXN0LmpzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gVGFza0FwcCgpIHtcbiAgY29uc3QgW3Rhc2tzLCBkaXNwYXRjaF0gPSB1c2VSZWR1Y2VyKHRhc2tzUmVkdWNlciwgaW5pdGlhbFRhc2tzKTtcblxuICBmdW5jdGlvbiBoYW5kbGVBZGRUYXNrKHRleHQpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiAnYWRkZWQnLFxuICAgICAgaWQ6IG5leHRJZCsrLFxuICAgICAgdGV4dDogdGV4dCxcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUNoYW5nZVRhc2sodGFzaykge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6ICdjaGFuZ2VkJyxcbiAgICAgIHRhc2s6IHRhc2ssXG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVEZWxldGVUYXNrKHRhc2tJZCkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6ICdkZWxldGVkJyxcbiAgICAgIGlkOiB0YXNrSWQsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDw+XG4gICAgICA8aDE+5biD5ouJ5qC855qE6KGM56iL5a6J5o6SPC9oMT5cbiAgICAgIDxBZGRUYXNrIG9uQWRkVGFzaz17aGFuZGxlQWRkVGFza30gLz5cbiAgICAgIDxUYXNrTGlzdFxuICAgICAgICB0YXNrcz17dGFza3N9XG4gICAgICAgIG9uQ2hhbmdlVGFzaz17aGFuZGxlQ2hhbmdlVGFza31cbiAgICAgICAgb25EZWxldGVUYXNrPXtoYW5kbGVEZWxldGVUYXNrfVxuICAgICAgLz5cbiAgICA8Lz5cbiAgKTtcbn1cblxuZnVuY3Rpb24gdGFza3NSZWR1Y2VyKHRhc2tzLCBhY3Rpb24pIHtcbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgJ2FkZGVkJzoge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgLi4udGFza3MsXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogYWN0aW9uLmlkLFxuICAgICAgICAgIHRleHQ6IGFjdGlvbi50ZXh0LFxuICAgICAgICAgIGRvbmU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgXTtcbiAgICB9XG4gICAgY2FzZSAnY2hhbmdlZCc6IHtcbiAgICAgIHJldHVybiB0YXNrcy5tYXAoKHQpID0+IHtcbiAgICAgICAgaWYgKHQuaWQgPT09IGFjdGlvbi50YXNrLmlkKSB7XG4gICAgICAgICAgcmV0dXJuIGFjdGlvbi50YXNrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY2FzZSAnZGVsZXRlZCc6IHtcbiAgICAgIHJldHVybiB0YXNrcy5maWx0ZXIoKHQpID0+IHQuaWQgIT09IGFjdGlvbi5pZCk7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHRocm93IEVycm9yKCfmnKrnn6UgYWN0aW9uOiAnICsgYWN0aW9uLnR5cGUpO1xuICAgIH1cbiAgfVxufVxuXG5sZXQgbmV4dElkID0gMztcbmNvbnN0IGluaXRpYWxUYXNrcyA9IFtcbiAge2lkOiAwLCB0ZXh0OiAn5Y+C6KeC5Y2h5aSr5Y2h5Y2a54mp6aaGJywgZG9uZTogdHJ1ZX0sXG4gIHtpZDogMSwgdGV4dDogJ+eci+acqOWBtuaIjycsIGRvbmU6IGZhbHNlfSxcbiAge2lkOiAyLCB0ZXh0OiAn5omT5Y2h5YiX5L6s5aKZJywgZG9uZTogZmFsc2V9XG5dO1xuYGBgXG5cbiMjIEhvb2tzVGVzdCBDb21wb25lbnQgd2l0aCB1c2VFZmZlY3QgZm9yIFN0YXRlIE1hbmFnZW1lbnRcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2hlamlhbGlhbmdoZS9TZW5pb3ItRnJvbnRFbmQvbWFpbi9kb2NzL3JlYWN0L3JlYWN0LWhvb2tzLm1kXG5cbmBgYFxuaW1wb3J0IFJlYWN0LHt1c2VFZmZlY3R9IGZyb20gJ3JlYWN0Jztcbi8vIOaIkeS7rOWPr+S7peaKinVzZUVmZmVjdCDnnIvlgZpjb21wb25lbnREaWRtb3VudOOAgWNvbXBvbmVudERpZFVwZGF0ZeOAgWNvbXBvbm50V2lsbFVubW91bnRcbmNvbnN0IEhvb2tzVGVzdCA9ICgpID0+IHtcbiAgICBjb25zdCBbY291bnQsIHNldENvdW50XSA9IHVzZVN0YXRlKDApO1xuICAgIC8vIHVzZUVmZmVjdOWPr+S7peiuqeS9oOWcqOesrOS4gOS4quWPguaVsOeahOWHveaVsOS4reaJp+ihjOWJr+S9nOeUqOaTjeS9nO+8jOWwseaYr+ivt+axguaVsOaNru+8jGRvbeaTjeS9nOS5i+exu+eahFxuICAgIC8vIHVzZUVmZmVjdOi/lOWbnuS4gOS4quWHveaVsO+8jOWHveaVsOmHjOihqOekuuimgea4hemZpOeahOWJr+S9nOeUqO+8jOS+i+Wmgua4hemZpOWumuaXtuWZqCzov5Tlm57nmoTlh73mlbDkvJrlnKjljbjovb3nu4Tku7bml7bmiafooYxcbiAgICB1c2VFZmZlY3QoKCk9PntcbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBgWW91IGNsaWNrZWQgJHtjb3VudH0gdGltZXNgO1xuICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpXG4gICAgICAgIH1cbiAgICB9KVxuICAgIC8qXG4gICAgICB1c2VFZmZlY3TnmoTnrKzkuozkuKrlj4LmlbDvvIzpgJrov4flnKjmlbDnu4TkuK3kvKDpgJLlgLzvvIzkvovlpoLlj6rmnIljb3VudOWPmOWMluaXtuaJjeiwg+eUqEVmZmVjdO+8jOi+vuWIsFxuICAgICAg5LiN55So5q+P5qyh5riy5p+T5ZCO6YO95omn6KGM5riF55CG5oiW5omn6KGMZWZmZWN05a+86Ie055qE5oCn6IO96Zeu6aKYXG4gICAgKi9cbiAgICB1c2VFZmZlY3QoKCk9PntcbiAgICAgZG9jdW1lbnQudGl0bGUgPSBgWW91IGNsaWNrZWQgJHtjb3VudH0gdGltZXNgO1xuICAgIH0sW2NvdW50XSlcblxuICAgIC8qXG4gICAg5aaC5p6c5oOz5omn6KGM5Y+q6L+Q6KGM5LiA5qyh55qEZWZmZWN077yI5LuF5Zyo57uE5Lu25oyC6L295ZKM5Y246L295pe25omn6KGM77yJ77yM5Y+v5Lul5Lyg6YCS5LiA5Liq56m65pWw57uE77yMXG4gICAg5ZGK6K+JUmVhY3TkvaDnmoRFZmZlY3TkuI3kvp3otZbkuI5wcm9wc+aIlnN0YXRl5Lit5Lu75L2V5YC8XG4gICAgKi9cbiAgICB1c2VFZmZlY3QoKCk9PntcbiAgICAgZG9jdW1lbnQudGl0bGUgPSBgWW91IGNsaWNrZWQgJHtjb3VudH0gdGltZXNgO1xuICAgIH0sW10pXG5cbiAgICAvKiBcbiAgICAgIOWPr+S7peS9v+eUqOWkmuS4qkVmZmVjdO+8jOWwhuS4jeebuOWFs+eahOmAu+i+keWIhuemu+WIsOS4jeWQjOeahGVmZmVjdOS4rVxuICAgICovXG4gICB1c2VFZmZlY3QoKCk9PntcbiAgICAgICBheGlvcy5nZXQoJ2xvZ2luJylcbiAgIH0sW10pXG4gICAgcmV0dXJuKFxuICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxwPllvdSBjbGlja2VkIHtjb3VudH0gdGltZXM8L3A+XG4gICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldENvdW50KGNvdW50ICsgMSl9PlxuICAgICAgICAgICAgICAgIENsaWNrIG1lXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgIDwvZGl2PlxuICAgIClcbn1cbmBgYFxuXG4jIyBDdXN0b20gUmVhY3QgSG9vayB1c2VNeVN0YXRlIGZvciBTdGF0ZSBNYW5hZ2VtZW50XG5cbmh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGVueGlhb2NodW4vYmxvZy9tYWluL2FydGljbGUvY3VzdG9tLXJlYWN0LWhvb2subWRcblxuYGBgXG5pbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0J1xuXG5jb25zdCBteVN0YXRlczogW2FueSwgKHY6IGFueSkgPT4gdm9pZF0gPSBbXVxubGV0IHN0YXRlSWQgPSAtMVxuXG5jb25zdCB1c2VNeVN0YXRlID0gKGRlZmF1bHRWYWx1ZTogbnVtYmVyKSA9PiB7XG4gIGlmIChteVN0YXRlc1tzdGF0ZUlkXSkge1xuICAgIHJldHVybiBteVN0YXRlc1tzdGF0ZUlkXVxuICB9XG5cbiAgc3RhdGVJZCArPSAxXG4gIGNvbnN0IHNldE15VmFsdWUgPSAodmFsdWU6IGFueSkgPT4ge1xuICAgIG15U3RhdGVzW3N0YXRlSWRdWzBdID0gdmFsdWVcbiAgfVxuICBjb25zdCB0dXBsZSA9IFtkZWZhdWx0VmFsdWUsIHNldE15VmFsdWVdXG4gIG15U3RhdGVzW3N0YXRlSWRdID0gdHVwbGVcbiAgcmV0dXJuIHR1cGxlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBUZXN0KCkge1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKG51bGwpXG4gIGNvbnN0IFt2YWx1ZSwgc2V0VmFsdWVdID0gdXNlTXlTdGF0ZSgwKVxuICBjb25zdCBbcmVmcmVzaCwgc2V0UmVmcmVzaF0gPSB1c2VTdGF0ZSh7fSlcblxuICBjb25zdCBoYW5kbGVQbHVzID0gKCkgPT4ge1xuICAgIGlmICh2YWx1ZSA+PSAwKSB7XG4gICAgICBzZXRFcnJvcihudWxsKVxuICAgIH1cbiAgICBzZXRWYWx1ZSh2YWx1ZSArIDEpXG4gICAgc2V0UmVmcmVzaCh7fSlcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZU1pbnVzID0gKCkgPT4ge1xuICAgIGlmICh2YWx1ZSA8IDEpIHtcbiAgICAgIHNldEVycm9yKCdOdW1iZXLCoHNob3VsZMKgYmXCoHBvc2l0aXZlLicpXG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFZhbHVlKHZhbHVlIC0gMSlcbiAgICAgIHNldFJlZnJlc2goe30pXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIkFwcFwiIGRhdGEtb2JqPXtyZWZyZXNofT5cbiAgICAgIDxsYWJlbCBzdHlsZT17eyBoZWlnaHQ6IDMwLCBkaXNwbGF5OiAnYmxvY2snLCBjb2xvcjogJ3JlZCcgfX0+e2Vycm9yfTwvbGFiZWw+XG4gICAgICA8ZGl2PlxuICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZU1pbnVzfT5taW51czwvYnV0dG9uPlxuICAgICAgICA8c3BhbiBzdHlsZT17eyBtYXJnaW46IDMwIH19Pnt2YWx1ZX08L3NwYW4+XG4gICAgICAgIDxidXR0b24gb25DbGljaz17aGFuZGxlUGx1c30+cGx1czwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIClcbn1cbmBgYFxuXG4jIyBDdXN0b20gUmVhY3QgSG9vayB1c2VUaW1lIGZvciBSZWFsLVRpbWUgQ2xvY2sgVXBkYXRlc1xuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVhY3Rqcy9hci5yZWFjdC5kZXYvbWFpbi9zcmMvY29udGVudC9yZWZlcmVuY2UvcnVsZXMvY29tcG9uZW50cy1hbmQtaG9va3MtbXVzdC1iZS1wdXJlLm1kXG5cbmBgYFxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcblxuZnVuY3Rpb24gdXNlVGltZSgpIHtcbiAgLy8gMS4gS2VlcCB0cmFjayBvZiB0aGUgY3VycmVudCBkYXRlJ3Mgc3RhdGUuIGB1c2VTdGF0ZWAgcmVjZWl2ZXMgYW4gaW5pdGlhbGl6ZXIgZnVuY3Rpb24gYXMgaXRzXG4gIC8vICAgIGluaXRpYWwgc3RhdGUuIEl0IG9ubHkgcnVucyBvbmNlIHdoZW4gdGhlIGhvb2sgaXMgY2FsbGVkLCBzbyBvbmx5IHRoZSBjdXJyZW50IGRhdGUgYXQgdGhlXG4gIC8vICAgIHRpbWUgdGhlIGhvb2sgaXMgY2FsbGVkIGlzIHNldCBmaXJzdC5cbiAgY29uc3QgW3RpbWUsIHNldFRpbWVdID0gdXNlU3RhdGUoKCkgPT4gbmV3IERhdGUoKSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyAyLiBVcGRhdGUgdGhlIGN1cnJlbnQgZGF0ZSBldmVyeSBzZWNvbmQgdXNpbmcgYHNldEludGVydmFsYC5cbiAgICBjb25zdCBpZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHNldFRpbWUobmV3IERhdGUoKSk7IC8vIOKchSBHb29kOiBub24taWRlbXBvdGVudCBjb2RlIG5vIGxvbmdlciBydW5zIGluIHJlbmRlclxuICAgIH0sIDEwMDApO1xuICAgIC8vIDMuIFJldHVybiBhIGNsZWFudXAgZnVuY3Rpb24gc28gd2UgZG9uJ3QgbGVhayB0aGUgYHNldEludGVydmFsYCB0aW1lci5cbiAgICByZXR1cm4gKCkgPT4gY2xlYXJJbnRlcnZhbChpZCk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gdGltZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ2xvY2soKSB7XG4gIGNvbnN0IHRpbWUgPSB1c2VUaW1lKCk7XG4gIHJldHVybiA8c3Bhbj57dGltZS50b0xvY2FsZVN0cmluZygpfTwvc3Bhbj47XG59XG5gYGBcblxuIyMgSW5pdGlhbGl6ZSBTdGF0ZSB3aXRoIHVzZUhvb2tzdGF0ZSBmb3IgQXJyYXkgTWFuYWdlbWVudFxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYXZrb25zdC9ob29rc3RhdGUvbWFpbi9kb2NzL2luZGV4L2RvY3MvMDQtbmVzdGVkLXN0YXRlLm1kXG5cbmBgYFxuY29uc3Qgc3RhdGUgPSB1c2VIb29rc3RhdGUoWzEsIDJdKVxuYGBgXG5cbiMjIFN0YXRlIE1hbmFnZW1lbnQgd2l0aCBSZWFjdCBIb29rc1xuXG5odHRwczovL3d3dy50dXRvcmlhbHNwb2ludC5jb20vcmVhY3Rqcy9yZWFjdGpzX3N0YXRlX21hbmFnZW1lbnRfcmVhY3RfaG9va3MuaHRtXG5cbmBgYFxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IEV4cGVuc2VFbnRyeUl0ZW1MaXN0Rm4gZnJvbSAnLi9jb21wb25lbnRzL0V4cGVuc2VFbnRyeUl0ZW1MaXN0Rm4nXG5cbmNvbnN0IGl0ZW1zID0gW1xuIHsgaWQ6IDEsIG5hbWU6IFwiUGl6emFcIiwgYW1vdW50OiA4MCwgc3BlbmREYXRlOiBcIjIwMjAtMTAtMTBcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiIH0sXG4geyBpZDogMiwgbmFtZTogXCJHcmFwZSBKdWljZVwiLCBhbW91bnQ6IDMwLCBzcGVuZERhdGU6IFwiMjAyMC0xMC0xMlwiLCBjYXRlZ29yeTogXCJGb29kXCIgfSxcbiB7IGlkOiAzLCBuYW1lOiBcIkNpbmVtYVwiLCBhbW91bnQ6IDIxMCwgc3BlbmREYXRlOiBcIjIwMjAtMTAtMTZcIiwgY2F0ZWdvcnk6IFwiRW50ZXJ0YWlubWVudFwiIH0sXG4geyBpZDogNCwgbmFtZTogXCJKYXZhIFByb2dyYW1taW5nIGJvb2tcIiwgYW1vdW50OiAyNDIsIHNwZW5kRGF0ZTogXCIyMDIwLTEwLTE1XCIsIGNhdGVnb3J5OiBcIkFjYWRlbWljXCIgfSxcbiB7IGlkOiA1LCBuYW1lOiBcIk1hbmdvIEp1aWNlXCIsIGFtb3VudDogMzUsIHNwZW5kRGF0ZTogXCIyMDIwLTEwLTE2XCIsIGNhdGVnb3J5OiBcIkZvb2RcIiB9LFxuIHsgaWQ6IDYsIG5hbWU6IFwiRHJlc3NcIiwgYW1vdW50OiAyMDAwLCBzcGVuZERhdGU6IFwiMjAyMC0xMC0yNVwiLCBjYXRlZ29yeTogXCJDbG90aFwiIH0sXG4geyBpZDogNywgbmFtZTogXCJUb3VyXCIsIGFtb3VudDogMjU1NSwgc3BlbmREYXRlOiBcIjIwMjAtMTAtMjlcIiwgY2F0ZWdvcnk6IFwiRW50ZXJ0YWlubWVudFwiIH0sXG4geyBpZDogOCwgbmFtZTogXCJNZWFsc1wiLCBhbW91bnQ6IDMwMCwgc3BlbmREYXRlOiBcIjIwMjAtMTAtMzBcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiIH0sXG4geyBpZDogOSwgbmFtZTogXCJNb2JpbGVcIiwgYW1vdW50OiAzNTAwLCBzcGVuZERhdGU6IFwiMjAyMC0xMS0wMlwiLCBjYXRlZ29yeTogXCJHYWRnZXRzXCIgfSxcbiB7IGlkOiAxMCwgbmFtZTogXCJFeGFtIEZlZXNcIiwgYW1vdW50OiAxMjQ1LCBzcGVuZERhdGU6IFwiMjAyMC0xMS0wNFwiLCBjYXRlZ29yeTogXCJBY2FkZW1pY1wiIH1cbl1cblJlYWN0RE9NLnJlbmRlcihcbiBcbiBcbiAsXG4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKVxuKTtcbmBgYFxuXG4jIyBNYW5hZ2UgTG9jYWwgYW5kIFNlcnZlciBTdGF0ZSB3aXRoIFJlYWN0IEhvb2tzXG5cbmh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jbG91ZHN0cmVldC1kZXYvUmVhY3QtaXMtQXdmdWwvbWFpbi8xOC1jaGFwdGVyLWFjY2VwdGFuY2UubWRcblxuYGBgXG4vLyBMb2NhbCBzdGF0ZSBmb3IgVUlcbmNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbi8vIFNlcnZlciBzdGF0ZSB3aXRoIFJlYWN0IFF1ZXJ5XG5jb25zdCB7IGRhdGEgfSA9IHVzZVF1ZXJ5KFsndG9kb3MnXSwgZmV0Y2hUb2Rvcyk7XG5cbi8vIEdsb2JhbCBzdGF0ZSBvbmx5IHdoZW4gdHJ1bHkgZ2xvYmFsXG5jb25zdCB0aGVtZSA9IHVzZUNvbnRleHQoVGhlbWVDb250ZXh0KTtcblxuLy8gTm8gUmVkdXggdW5sZXNzIHlvdSBhY3R1YWxseSBuZWVkIGl0ICh5b3UgcHJvYmFibHkgZG9uJ3QpXG5gYGBcblxuIyMganMgUmVzdWx0IDFcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3hpYW9oZXNvbmcvVElML21haW4vZnJvbnQtZW5kL3JlYWN0L2hvb2tzL2ludHJvLm1kXG5cbmBgYFxuaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5cbmZ1bmN0aW9uIEV4YW1wbGUoKSB7XG4gIC8vIERlY2xhcmUgYSBuZXcgc3RhdGUgdmFyaWFibGUsIHdoaWNoIHdlJ2xsIGNhbGwgXCJjb3VudFwiXG4gIGNvbnN0IFtjb3VudCwgc2V0Q291bnRdID0gdXNlU3RhdGUoMCk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2PlxuICAgICAgPHA+WW91IGNsaWNrZWQge2NvdW50fSB0aW1lczwvcD5cbiAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0Q291bnQoY291bnQgKyAxKX0+XG4gICAgICAgIENsaWNrIG1lXG4gICAgICA8L2J1dHRvbj5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbmBgYFxuXG4jIyBDdXN0b20gSG9vayB1c2VMb2NhbFN0b3JhZ2UgZm9yIFJlYWN0IFN0YXRlIE1hbmFnZW1lbnRcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tLzEwdXAvd3Atc2NhZmZvbGQvbWFpbi9kb2NzL2Zyb250ZW5kLWRldmVsb3BtZW50L2phdmFzY3JpcHQtZ3VpZGVsaW5lcy5tZFxuXG5gYGBcbi8vIGhvb2tzL3VzZUxvY2FsU3RvcmFnZS5qc1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcblxuZXhwb3J0IGNvbnN0IHVzZUxvY2FsU3RvcmFnZSA9IChrZXksIGluaXRpYWxWYWx1ZSkgPT4ge1xuICBjb25zdCBbdmFsdWUsIHNldFZhbHVlXSA9IHVzZVN0YXRlKCgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaXRlbSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgcmV0dXJuIGl0ZW0gPyBKU09OLnBhcnNlKGl0ZW0pIDogaW5pdGlhbFZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGZyb20gbG9jYWxTdG9yYWdlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBpbml0aWFsVmFsdWU7XG4gICAgfVxuICB9KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIHRvIGxvY2FsU3RvcmFnZTonLCBlcnJvcik7XG4gICAgfVxuICB9LCBba2V5LCB2YWx1ZV0pO1xuXG4gIHJldHVybiBbdmFsdWUsIHNldFZhbHVlXTtcbn07XG5cbi8vIFVzYWdlXG5jb25zdCBbdGhlbWUsIHNldFRoZW1lXSA9IHVzZUxvY2FsU3RvcmFnZSgndGhlbWUnLCAnbGlnaHQnKTtcbmBgYFxuXG4jIyBDdXN0b20gSG9vayB1c2VDYXRGYWN0IGZvciBGZXRjaGluZyBDYXQgRmFjdHNcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL21pZHVkZXYvY3Vyc29yZWFjdC5kZXYvbWFpbi9zcmMvY2xhc2VzLzA0LWN1c3RvbS1ob29rcy5tZHhcblxuYGBgXG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBnZXRSYW5kb21GYWN0IH0gZnJvbSAnLi4vc2VydmljZXMvZmFjdHMuanMnIC8vIDwtLSBJbXBvcnRhbW9zIGxhIGZ1bmNpw7NuIGRlIHNlcnZpY2lvXG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYXRGYWN0ICgpIHsgLy8gPC0tIEVzIHVuYSBmdW5jacOzbiBxdWUgZW1waWV6YSBwb3IgXCJ1c2VcIlxuICBjb25zdCBbZmFjdCwgc2V0RmFjdF0gPSB1c2VTdGF0ZSgpIC8vIDwtLSBVdGlsaXphIHVzZVN0YXRlIGludGVybmFtZW50ZVxuXG4gIGNvbnN0IHJlZnJlc2hGYWN0ID0gKCkgPT4geyAvLyA8LS0gRXMgdW5hIGZ1bmNpw7NuIHF1ZSBleHBvbmUgbGEgYWNjacOzbiBkZSBhY3R1YWxpemFyXG4gICAgZ2V0UmFuZG9tRmFjdCgpLnRoZW4obmV3RmFjdCA9PiBzZXRGYWN0KG5ld0ZhY3QpKVxuICB9XG5cbiAgLy8gcGFyYSByZWN1cGVyYXIgbGEgY2l0YSBhbCBjYXJnYXIgbGEgcMOhZ2luYVxuICB1c2VFZmZlY3QoKCkgPT4geyAvLyA8LS0gVXRpbGl6YSB1c2VFZmZlY3QgaW50ZXJuYW1lbnRlXG4gICAgcmVmcmVzaEZhY3QoKSAvLyA8LS0gTGxhbWEgYSBsYSBhY2Npw7NuIGludGVybmEgYWwgbW9udGFyXG4gIH0sIFtdKSAvLyA8LS0gU29sbyBzZSBlamVjdXRhIGFsIHJlbmRlcml6YXIgcG9yIHByaW1lcmEgdmV6XG5cbiAgcmV0dXJuIHsgZmFjdCwgcmVmcmVzaEZhY3QgfSAvLyA8LS0gRGV2dWVsdmUgZWwgZXN0YWRvIHkgbGEgYWNjacOzblxufVxuYGBgXG5cbiMjIEN1c3RvbSBIb29rIHVzZUxvY2FsU3RvcmFnZSBmb3IgUmVhY3QgU3RhdGUgTWFuYWdlbWVudFxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ2hhbGFyYW5nZWxvLzMwLXNlY29uZHMtb2YtY29kZS9tYWluL2NvbnRlbnQvc25pcHBldHMvcmVhY3Qvcy9wZXJzaXN0LXN0YXRlLXRvLXN0b3JhZ2UubWRcblxuYGBgXG5jb25zdCB1c2VMb2NhbFN0b3JhZ2UgPSAoa2V5TmFtZSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gIGNvbnN0IFtzdG9yZWRWYWx1ZSwgc2V0U3RvcmVkVmFsdWVdID0gUmVhY3QudXNlU3RhdGUoKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXlOYW1lKTtcblxuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXlOYW1lLCBKU09OLnN0cmluZ2lmeShkZWZhdWx0VmFsdWUpKTtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBzZXRWYWx1ZSA9IG5ld1ZhbHVlID0+IHtcbiAgICB0cnkge1xuICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleU5hbWUsIEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7fVxuICAgIHNldFN0b3JlZFZhbHVlKG5ld1ZhbHVlKTtcbiAgfTtcblxuICByZXR1cm4gW3N0b3JlZFZhbHVlLCBzZXRWYWx1ZV07XG59O1xuXG5jb25zdCBNeUFwcCA9ICgpID0+IHtcbiAgY29uc3QgW25hbWUsIHNldE5hbWVdID0gdXNlTG9jYWxTdG9yYWdlKCduYW1lJywgJ0pvaG4nKTtcblxuICByZXR1cm4gPGlucHV0IHZhbHVlPXtuYW1lfSBvbkNoYW5nZT17ZSA9PiBzZXROYW1lKGUudGFyZ2V0LnZhbHVlKX0gLz47XG59O1xuXG5SZWFjdERPTS5jcmVhdGVSb290KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpLnJlbmRlcihcbiAgPE15QXBwIC8+XG4pO1xuYGBgXG5cbiMjIEN1c3RvbSBIb29rIHVzZU1lcmdlU3RhdGUgZm9yIE1lcmdpbmcgUmVhY3QgU3RhdGVcblxuaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NoYWxhcmFuZ2Vsby8zMC1zZWNvbmRzLW9mLWNvZGUvbWFpbi9jb250ZW50L3NuaXBwZXRzL3JlYWN0L3MvYWR2YW5jZWQtcmVhY3Qtc3RhdGUtaG9va3MubWRcblxuYGBgXG5jb25zdCB1c2VNZXJnZVN0YXRlID0gKGluaXRpYWxTdGF0ZSA9IHt9KSA9PiB7XG4gIGNvbnN0IFt2YWx1ZSwgc2V0VmFsdWVdID0gUmVhY3QudXNlU3RhdGUoaW5pdGlhbFN0YXRlKTtcblxuICBjb25zdCBtZXJnZVN0YXRlID0gbmV3U3RhdGUgPT4ge1xuICAgIGlmICh0eXBlb2YgbmV3U3RhdGUgPT09ICdmdW5jdGlvbicpIG5ld1N0YXRlID0gbmV3U3RhdGUodmFsdWUpO1xuICAgIHNldFZhbHVlKHsgLi4udmFsdWUsIC4uLm5ld1N0YXRlIH0pO1xuICB9O1xuXG4gIHJldHVybiBbdmFsdWUsIG1lcmdlU3RhdGVdO1xufTtcblxuY29uc3QgTXlBcHAgPSAoKSA9PiB7XG4gIGNvbnN0IFtkYXRhLCBzZXREYXRhXSA9IHVzZU1lcmdlU3RhdGUoeyBuYW1lOiAnSm9obicsIGFnZTogMjAgfSk7XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgPGlucHV0XG4gICAgICAgIHZhbHVlPXtkYXRhLm5hbWV9XG4gICAgICAgIG9uQ2hhbmdlPXtlID0+IHNldERhdGEoeyBuYW1lOiBlLnRhcmdldC52YWx1ZSB9KX1cbiAgICAgIC8+XG4gICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldERhdGEoKHsgYWdlIH0pID0+ICh7IGFnZTogYWdlIC0gMSB9KSl9PlxuICAgICAgICAtXG4gICAgICA8L2J1dHRvbj5cbiAgICAgIHtkYXRhLmFnZX1cbiAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0RGF0YSgoeyBhZ2UgfSkgPT4gKHsgYWdlOiBhZ2UgKyAxIH0pKX0+XG4gICAgICAgICtcbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvPlxuICApO1xufTtcblxuUmVhY3RET00uY3JlYXRlUm9vdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpKS5yZW5kZXIoXG4gIDxNeUFwcCAvPlxuKTtcbmBgYFxuXG4jIyBDdXN0b20gUmVhY3QgSG9vayB1c2VDb3VudGVyIGZvciBTdGF0ZSBNYW5hZ2VtZW50XG5cbmh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWZpbmVkZXYvcmVmaW5lL21haW4vZG9jdW1lbnRhdGlvbi9ibG9nLzIwMjQtMDgtMDUtcmVhY3QtdW5pdC10ZXN0aW5nLm1kXG5cbmBgYFxuaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcblxuY29uc3QgdXNlQ291bnRlciA9ICgpID0+IHtcbiAgY29uc3QgW2NvdW50LCBzZXRDb3VudF0gPSB1c2VTdGF0ZSgwKTtcblxuICBjb25zdCBpbmNyZW1lbnQgPSAoKSA9PiB7XG4gICAgc2V0Q291bnQoKHByZXZDb3VudCkgPT4gcHJldkNvdW50ICsgMSk7XG4gIH07XG5cbiAgY29uc3QgZGVjcmVtZW50ID0gKCkgPT4ge1xuICAgIHNldENvdW50KChwcmV2Q291bnQpID0+IHByZXZDb3VudCAtIDEpO1xuICB9O1xuXG4gIHJldHVybiB7IGNvdW50LCBpbmNyZW1lbnQsIGRlY3JlbWVudCB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdXNlQ291bnRlcjtcbmBgYFxuXG4jIyBDdXN0b20gUmVhY3QgSG9vayB1c2VDb3VudGVyIGZvciBTdGF0ZSBNYW5hZ2VtZW50XG5cbmh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9rZW50Y2RvZGRzL2tlbnRjZG9kZHMuY29tL21haW4vY29udGVudC9ibG9nL3JlYWN0LWhvb2tzLXdoYXRzLWdvaW5nLXRvLWhhcHBlbi10by1teS10ZXN0cy5tZHhcblxuYGBgXG5mdW5jdGlvbiB1c2VDb3VudGVyKCkge1xuXHRjb25zdCBbY291bnQsIHNldENvdW50XSA9IHVzZVN0YXRlKDApXG5cdGNvbnN0IGluY3JlbWVudCA9ICgpID0+IHNldENvdW50KChjdXJyZW50Q291bnQpID0+IGN1cnJlbnRDb3VudCArIDEpXG5cdHJldHVybiB7IGNvdW50LCBpbmNyZW1lbnQgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB1c2VDb3VudGVyXG5cbi8vIHVzYWdlOlxuLy8gZnVuY3Rpb24gQ291bnRlcigpIHtcbi8vICAgY29uc3Qge2NvdW50LCBpbmNyZW1lbnR9ID0gdXNlQ291bnRlcigpXG4vLyAgIHJldHVybiA8YnV0dG9uIG9uQ2xpY2s9e2luY3JlbWVudH0+e2NvdW50fTwvYnV0dG9uPlxuLy8gfVxuYGBgXG5cbiMjIEN1c3RvbSBIb29rIHVzZUxvY2FsU3RvcmFnZSBmb3IgUmVhY3QgU3RhdGUgTWFuYWdlbWVudFxuXG5odHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmVjaGluL3JlZmVyZW5jZS9tYWluL3NvdXJjZS9fcG9zdHMvcmVhY3QubWRcblxuYGBgXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuXG5mdVxuYGBgXG5cbiIsInJlc3VsdHNDb3VudCI6NTA0LCJjb3N0RG9sbGFycyI6IntcInRvdGFsXCI6MSxcInNlYXJjaFwiOntcIm5ldXJhbFwiOjF9fSIsInNlYXJjaFRpbWUiOjMwNjUuMDY1MDU4LCJvdXRwdXRUb2tlbnMiOjUwMDB9
  recorded_at: Tue, 28 Oct 2025 16:13:28 GMT
recorded_with: VCR 6.3.1
